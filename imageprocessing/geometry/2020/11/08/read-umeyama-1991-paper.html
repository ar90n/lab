<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Least-Squares Estimation of Transformation Parameters Between Two Point Patterns の読解 | lab note</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Least-Squares Estimation of Transformation Parameters Between Two Point Patterns の読解" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Read a thesis whose name is Least-Squares Estimation of Transformation Parameters Between Two Point Patterns" />
<meta property="og:description" content="Read a thesis whose name is Least-Squares Estimation of Transformation Parameters Between Two Point Patterns" />
<link rel="canonical" href="https://lab.ar90n.net/imageprocessing/geometry/2020/11/08/read-umeyama-1991-paper.html" />
<meta property="og:url" content="https://lab.ar90n.net/imageprocessing/geometry/2020/11/08/read-umeyama-1991-paper.html" />
<meta property="og:site_name" content="lab note" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-11-08T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"Read a thesis whose name is Least-Squares Estimation of Transformation Parameters Between Two Point Patterns","url":"https://lab.ar90n.net/imageprocessing/geometry/2020/11/08/read-umeyama-1991-paper.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://lab.ar90n.net/imageprocessing/geometry/2020/11/08/read-umeyama-1991-paper.html"},"headline":"Least-Squares Estimation of Transformation Parameters Between Two Point Patterns の読解","dateModified":"2020-11-08T00:00:00-06:00","datePublished":"2020-11-08T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://lab.ar90n.net/feed.xml" title="lab note" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-90473091-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">lab note</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Least-Squares Estimation of Transformation Parameters Between Two Point Patterns の読解</h1><p class="page-description">Read a thesis whose name is Least-Squares Estimation of Transformation Parameters Between Two Point Patterns</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-11-08T00:00:00-06:00" itemprop="datePublished">
        Nov 8, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      21 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#ImageProcessing">ImageProcessing</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Geometry">Geometry</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/ar90n/lab/tree/fastpages/_notebooks/2020-11-08-read-umeyama-1991-paper.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/ar90n/lab/fastpages?filepath=_notebooks%2F2020-11-08-read-umeyama-1991-paper.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/ar90n/lab/blob/fastpages/_notebooks/2020-11-08-read-umeyama-1991-paper.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#はじめに">はじめに </a></li>
<li class="toc-entry toc-h2"><a href="#やったこと">やったこと </a></li>
<li class="toc-entry toc-h2"><a href="#行列の性質復習">行列の性質復習 </a></li>
<li class="toc-entry toc-h2"><a href="#相似変換について">相似変換について </a></li>
<li class="toc-entry toc-h2"><a href="#回転行列の推定">回転行列の推定 </a></li>
<li class="toc-entry toc-h2"><a href="#相似変換の推定">相似変換の推定 </a></li>
<li class="toc-entry toc-h2"><a href="#Pythonによる実装">Pythonによる実装 </a></li>
<li class="toc-entry toc-h2"><a href="#参考">参考 </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-11-08-read-umeyama-1991-paper.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="はじめに">
<a class="anchor" href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB" aria-hidden="true"><span class="octicon octicon-link"></span></a>はじめに<a class="anchor-link" href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"> </a>
</h2>
<p>拡大と回転と並進とによって実現する幾何学変換に相似変換があります．これは，画像間の位置合わせ等に用いられます．
具体的には，互いに対応する点${x_{i}}$と$y_{i}$$\left(i = 1, 2, \dots n \right)$が与えられた時，それらの間に存在する相似変換を推定するといったものです．</p>
<p>これを実現アルゴリズムにS.Umeyamaによって提案された手法があります．古典的な手法ではありますが，実用的なアルゴリズムであると思います．scikit-imageにおける<a href="https://github.com/scikit-image/scikit-image/blob/d88b92b734875ce9adcf429786d0e3a975f5ffdd/skimage/transform/_geometric.py#L72">SimilalityTransform</a>でも使用されています．</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="やったこと">
<a class="anchor" href="#%E3%82%84%E3%81%A3%E3%81%9F%E3%81%93%E3%81%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>やったこと<a class="anchor-link" href="#%E3%82%84%E3%81%A3%E3%81%9F%E3%81%93%E3%81%A8"> </a>
</h2>
<ul>
<li>Least-Squares Estimation of Transformation Parameters Between Two Point Patternsによる提案手法を読む</li>
<li>Pythonによる簡易的な実装</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="行列の性質復習">
<a class="anchor" href="#%E8%A1%8C%E5%88%97%E3%81%AE%E6%80%A7%E8%B3%AA%E5%BE%A9%E7%BF%92" aria-hidden="true"><span class="octicon octicon-link"></span></a>行列の性質復習<a class="anchor-link" href="#%E8%A1%8C%E5%88%97%E3%81%AE%E6%80%A7%E8%B3%AA%E5%BE%A9%E7%BF%92"> </a>
</h2>
<p>以下にこれから利用する行列の性質を示します．ここで，$\mathbf A = \left(a_{i,j}\right)$及び$\mathbf B = \left(b_{i,j}\right)$は行列を，$\left&lt;\cdot, \cdot\right&gt;$は行列の内積を表します．</p>
$$
\begin{aligned}
\mathrm {tr} \mathbf A &amp;= \mathrm {tr} \mathbf A^{\mathrm T}  \\
\mathrm {tr} \mathbf A \mathbf B \mathbf C &amp;= \mathrm {tr} \mathbf B \mathbf C \mathbf A \\
\mathrm {tr} \mathbf A^{\mathrm T} \mathbf B &amp;= \left&lt;\mathbf A, \mathbf B \right&gt; \\
&amp;= \left\|\mathbf A \mathbf B \right\|^{2} \\
\frac{\partial}{\partial \mathbf A} \mathrm {tr} \left(\mathbf A \mathbf B\right) &amp;= \mathbf B^{T} \\
\frac{\partial}{\partial \mathbf A} \mathrm {tr} \left(\mathbf A^{\mathrm T} \mathbf B\right) &amp;= \mathbf B \\
\frac{\partial}{\partial \mathbf A} \mathrm {tr} \left(f\left(\mathbf A\right) g\left(\mathbf A\right)\right) &amp;= \frac{\partial}{\partial \mathbf A_{1}} \mathrm {tr} \left(f\left(\mathbf A_{1}\right) g\left(\mathbf A\right)\right) + \frac{\partial}{\partial \mathbf A_{2}} \mathrm {tr} \left(f\left(\mathbf A\right) g\left(\mathbf A_{2}\right)\right)  \\
\left&lt;\mathbf A, \mathbf B \right&gt; &amp;= \mathrm {tr} \mathbf A^{\mathrm T} B \\
&amp;= \sum_{i,j} a_{j,i}b_{i,j}
\end{aligned}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="相似変換について">
<a class="anchor" href="#%E7%9B%B8%E4%BC%BC%E5%A4%89%E6%8F%9B%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6" aria-hidden="true"><span class="octicon octicon-link"></span></a>相似変換について<a class="anchor-link" href="#%E7%9B%B8%E4%BC%BC%E5%A4%89%E6%8F%9B%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"> </a>
</h2>
<p>上述したとおり，相似変換とは拡大と回転と並進とによって実現する幾何学的変換です．従って，変換元を$\mathbf x$，変換先を$\mathbf x'$，拡大率，回転行列，並進ベクトルをそれぞれ$\left(c, \mathbf R, \mathbf t \right)$とすると</p>
$$
\begin{aligned}
\mathbf x' &amp;= c\mathbf R \mathbf x  + \mathbf t
\end{aligned}
$$<p>と表されます．</p>
<p>ここで，特徴点$\mathbf x_{i}$と，その相似変換による変換$\mathbf y_{i}\ \left(i = 1, 2, \dots , n \right)$を観測した場合を考えます．この時，以下の$e\left(c, \mathbf R, \mathbf t\right)$を最小化することで，$\mathbf x_{i}$と$\mathbf y_{i}$から相似変換のパラメータ$\left(c, \mathbf R, \mathbf t \right)$を推定することができます．</p>
$$
\begin{aligned}
e^{2}\left(c, \mathbf R, \mathbf t\right) &amp;= \frac{1}{n} \sum_{i=1}^{n} \left| \mathbf y_{i} - \left(c\mathbf R \mathbf x_{i} + \mathbf t\right)\right|^{2}
\end{aligned}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="回転行列の推定">
<a class="anchor" href="#%E5%9B%9E%E8%BB%A2%E8%A1%8C%E5%88%97%E3%81%AE%E6%8E%A8%E5%AE%9A" aria-hidden="true"><span class="octicon octicon-link"></span></a>回転行列の推定<a class="anchor-link" href="#%E5%9B%9E%E8%BB%A2%E8%A1%8C%E5%88%97%E3%81%AE%E6%8E%A8%E5%AE%9A"> </a>
</h2>
<p>相似変換に推定の先立ち，まずは以下の式を最小化する$\mathbf R$を推定することを考えます．ここで，$\mathbf A$及び$\mathbf B$は$m \times n$の行列を，$\mathbf R$は$m \times m$の行列を表します．</p>
$$
\begin{alignedat}{4}
 \text{minimize}  &amp; \ \ \ \ \  &amp;  \left\| \mathbf A - \mathbf R \mathbf B\right\|^{2}  &amp; \\
 \text{subject to} &amp;\ &amp;\left|\mathbf R \right| &amp;= 1&amp; \\
                   &amp;\ &amp; \mathbf R\mathbf R^{\mathrm T} &amp;= \mathbf I 
\end{alignedat}
$$<p>$\mathbf R$を適切に推定するためには，与えられた束縛条件の元で目的関数を最小化する必要があります．従って，ラグランジュの未定乗数法を用います．ここでは，ラグランジュ関数$F$は以下の様に表されます．なお，$l_{i,j}$及び$g$はラグランジュ乗数となります．</p>
$$
\begin{aligned}
F &amp;= \left\|\mathbf A - \mathbf R \mathbf B \right\|^{2} + \sum_{i=1}^{m} \sum_{j=1}^{m} l_{i,j} \left(\mathbf R^{\mathrm T}\mathbf R - \mathbf I \right)_{i,j} + g\left(\left|\mathbf R \right| - 1 \right)
\end{aligned}
$$<p>上式において，$\mathbf R^{\mathrm T}\mathbf R$と$\mathbf I$は対象行列です．従って，それらの差である$ \left(\mathbf R^{\mathrm T}\mathbf R - \mathbf I \right)$も対象行列となります．$ \left(\mathbf R^{\mathrm T}\mathbf R - \mathbf I \right)$が対象行列であるならば，対象な成分に対応するラグランジュ乗数も同様に等しくなります．すなわち，</p>
$$
\begin{aligned}
l_{i,j} &amp;= l_{j,i}
\end{aligned}
$$<p>となります．従って，ラグランジュ関数の第2項は以下の様に表現することが可能です．</p>
$$
\begin{aligned}
\sum_{i=1}^{m} \sum_{j=1}^{m} l_{i,j} \left(\mathbf R^{\mathrm T}\mathbf R - \mathbf I \right)_{i,j}　&amp;= \left&lt; \left(l_{i,j}\right), \mathbf R^{\mathrm T}\mathbf R - \mathbf I  \right&gt;\\
&amp;= \mathrm{tr} \left(\left(l_{j,i}\right) \left(\mathbf R^{\mathrm T}\mathbf R - \mathbf I \right)\right)\\
&amp;= \mathrm{tr} \left(\left(l_{i,j}\right) \left(\mathbf R^{\mathrm T}\mathbf R - \mathbf I \right)\right)\\
\end{aligned}
$$<p>ここで，</p>
$$
\begin{aligned}
\mathbf L &amp;= \left(l_{i,j} \right)
\end{aligned}
$$<p>と置くと，</p>
$$
\begin{aligned}
\mathrm{tr} \left(\left(l_{i,j}\right) \left(\mathbf R^{\mathrm T}\mathbf R - \mathbf I \right)\right)　&amp;= \mathrm{tr}\left( \mathbf L \left(\mathbf R^{\mathrm T}\mathbf R - \mathbf I \right)\right)\\
\end{aligned}
$$<p>と表すことができます．従って，ラグランジュ関数$F$は以下の様に表現されます．</p>
$$
\begin{aligned}
F &amp;= \left\|\mathbf A - \mathbf R \mathbf B \right\|^{2} + \mathrm{tr} \left(\mathbf L \left(\mathbf R^{\mathrm T}\mathbf R - \mathbf I \right)  \right) + g\left(\left|\mathbf R \right| - 1 \right) \\
\end{aligned}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$F$を最小化する$\mathbf R$を求めるためには，以下の式を$\mathbf R$について解く必要があります．</p>
$$
\begin{aligned}
\frac{\partial F}{\partial \mathbf R} &amp;= \frac{\partial}{\partial \mathbf R} \left\|\mathbf A - \mathbf R \mathbf B \right\|^{2} + \frac{\partial}{\partial \mathbf R} \mathrm{tr} \left(\mathbf L \left(\mathbf R^{\mathrm T}\mathbf R - \mathbf I \right)  \right) +\frac{\partial}{\partial \mathbf R}  g\left(\left|\mathbf R \right| - 1 \right) \\
&amp;= 0
\end{aligned}
$$<p>まずは，右辺第１項について考えます．</p>
$$
\begin{aligned}
\frac{\partial}{\partial \mathbf R} \left\|\mathbf A - \mathbf R \mathbf B \right\|^{2} &amp;=  \frac{\partial}{\partial \mathbf R} \mathrm{tr} \left(\left(\mathbf A - \mathbf R \mathbf B \right)^{\mathrm T}\left(\mathbf A - \mathbf R \mathbf B \right)\right) \\
&amp;=  \frac{\partial}{\partial \mathbf R} \mathrm{tr} \left(\mathbf A^{\mathrm T} \mathbf A - \mathbf A^{\mathrm T}\mathbf R \mathbf B - \mathbf B^{\mathrm T}\mathbf R^{\mathrm T} \mathbf A + \mathbf B^{\mathrm T}\mathbf R^{\mathrm T} \mathbf R \mathbf B\right) \\
&amp;=  \frac{\partial}{\partial \mathbf R} \mathrm{tr} \left(\mathbf A^{\mathrm T} \mathbf A\right) - \frac{\partial}{\partial \mathbf R} \mathrm{tr} \left(\mathbf A^{\mathrm T}\mathbf R \mathbf B\right) + \frac{\partial}{\partial \mathbf R} \mathrm{tr} \left(\mathbf B^{\mathrm T}\mathbf R^{\mathrm T} \mathbf A \right) +\frac{\partial}{\partial \mathbf R} \mathrm{tr} \left(\mathbf B^{\mathrm T}\mathbf R^{\mathrm T} \mathbf R \mathbf B\right) \\
&amp;=  - \frac{\partial}{\partial \mathbf R} \mathrm{tr} \left(\mathbf B \mathbf A^{\mathrm T}\mathbf R\right) - \frac{\partial}{\partial \mathbf R} \mathrm{tr} \left(\mathbf A\mathbf B^{\mathrm T}\mathbf R^{\mathrm T}\right) +\frac{\partial}{\partial \mathbf R_{1}} \mathrm{tr} \left(\mathbf B^{\mathrm T}\mathbf R_{1}^{\mathrm T} \mathbf R \mathbf B\right)  +\frac{\partial}{\partial \mathbf R_{2}} \mathrm{tr} \left(\mathbf B^{\mathrm T}\mathbf R^{\mathrm T} \mathbf R_{2} \mathbf B\right) \\ \\
&amp;=  - \mathbf A \mathbf B^{\mathrm T} - \mathbf A\mathbf B^{\mathrm T} + \frac{\partial}{\partial \mathbf R_{1}} \mathrm{tr} \left(\mathbf R_{1}^{\mathrm T} \mathbf R \mathbf B\mathbf B^{\mathrm T}\right)  +\frac{\partial}{\partial \mathbf R_{2}} \mathrm{tr} \left(\mathbf B\mathbf B^{\mathrm T}\mathbf R^{\mathrm T} \mathbf R_{2}\right) \\ \\
&amp;= -2 \mathbf A \mathbf B^{\mathrm T} + \mathbf R \mathbf B \mathbf B^{\mathrm T} + \left(\mathbf B \mathbf B^{\mathrm T} \mathbf R^{\mathrm T} \right)^{\mathrm T} \\
&amp;= -2 \mathbf A \mathbf B^{\mathrm T} + \mathbf R \mathbf B \mathbf B^{\mathrm T} + \mathbf R \mathbf B \mathbf B^{\mathrm T}  \\
&amp;= -2 \mathbf A \mathbf B^{\mathrm T} + 2\mathbf R \mathbf B \mathbf B^{\mathrm T}
\end{aligned}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>次に，右辺第２項について考えます．</p>
$$
\begin{aligned}
\frac{\partial}{\partial \mathbf R} \mathrm{tr} \left(\mathbf L \left(\mathbf R^{\mathrm T}\mathbf R - \mathbf I \right)  \right) &amp;= \frac{\partial}{\partial \mathbf R} \mathrm{tr} \left(\mathbf L \mathbf R^{\mathrm T}\mathbf R \right) - \frac{\partial}{\partial \mathbf R} \mathrm{tr} \left(\mathbf L\right) \\
&amp;= \frac{\partial}{\partial \mathbf R_{1}}  \mathrm {tr} \left(\mathbf L \mathbf R_{1}^{\mathrm T} \mathbf R \right) + \frac{\partial}{\partial \mathbf R_{2}}  \mathrm {tr} \left(\mathbf L \mathbf R^{\mathrm T} \mathbf R_{2} \right)  \\
&amp;= \frac{\partial}{\partial \mathbf R_{1}}  \mathrm {tr} \left(\mathbf R \mathbf L \mathbf R_{1}^{\mathrm T}\right) + \left(\mathbf L \mathbf R^{\mathrm T}\right)^{\mathrm T}  \\
&amp;= \mathbf R \mathbf L  + \mathbf R \mathbf L^{\mathrm T}\\
&amp;= \mathbf R \mathbf L  + \mathbf R \mathbf L\\
&amp;= 2\mathbf R \mathbf L \\
\end{aligned}
$$<p>最後に，右辺第３項について考えます．</p>
$$
\begin{aligned}
\frac{\partial}{\partial \mathbf R}  g\left(\left|\mathbf R \right| - 1 \right) &amp;= g \frac{\partial}{\partial \mathbf R} \left|\mathbf R \right|\\
 &amp;= g \mathbf{R}\\
\end{aligned}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>以上の結果より，</p>
$$
\begin{aligned}
\frac{\partial F}{\partial \mathbf R}  &amp;= -2 \mathbf A \mathbf B^{\mathrm T} + 2\mathbf R \mathbf B \mathbf B^{\mathrm T} + 2\mathbf R \mathbf L +g \mathbf{R}  \\
&amp;= 0\\
\end{aligned}
$$<p>と表現することができます．上式を整理すると，</p>
$$
\begin{aligned}
2\mathbf R \mathbf B \mathbf B^{\mathrm T} + 2\mathbf R \mathbf L +g \mathbf{R}  &amp;=2 \mathbf A \mathbf B^{\mathrm T} \\
\mathbf R\left(\mathbf B \mathbf B^{\mathrm T} + \mathbf L + \frac{1}{2}g \mathbf I \right)  &amp;= \mathbf A \mathbf B^{\mathrm T} \\
\end{aligned}
$$<p>と表すことができます．ここで，</p>
$$
\begin{aligned}
\mathbf L'  &amp;= \mathbf B \mathbf B^{\mathrm T} + \mathbf L + \frac{1}{2}g \mathbf I
\end{aligned}
$$<p>と置きます．すると，</p>
$$
\begin{aligned}
\mathbf R\mathbf L'  &amp;= \mathbf A \mathbf B^{\mathrm T} \\
\mathbf L'^{\mathrm T}\mathbf R^{\mathrm T}  &amp;= \mathbf B \mathbf A^{\mathrm T} \\
\end{aligned}
$$<p>となります．$\mathbf B \mathbf B^{\mathrm T}$，$\mathbf L$及び$\mathbf I$は全て対象行列です．従って，</p>
$$
\begin{aligned}
\mathbf L'  &amp;= \mathbf L'^{\mathrm T}
\end{aligned}
$$<p>という関係が成立します．従って，</p>
$$
\begin{aligned}
\mathbf L'\mathbf R^{\mathrm T}  &amp;= \mathbf B \mathbf A^{\mathrm T} \\
\end{aligned}
$$<p>となります．ここで，両辺にそれぞれ自身の転置を掛けると，</p>
$$
\begin{aligned}
\mathbf L'\mathbf R^{\mathrm T} \left(\mathbf L'\mathbf R^{\mathrm T} \right)^{\mathrm T} &amp;= \mathbf L'\mathbf R^{\mathrm T} \mathbf R \mathbf L'^{\mathrm T}\\
&amp;= \mathbf L'\mathbf L'^{\mathrm T} \\
 &amp;= \mathbf L'^{2}\\
&amp;= \mathbf B \mathbf A^{\mathrm T} \left(\mathbf B \mathbf A^{\mathrm T} \right)^{\mathrm T}  \\
\end{aligned}
$$<p>となります．また，$\mathbf A\mathbf B^{\mathrm T}$の特異値分解を以下の様に置きます．</p>
$$
\begin{aligned}
\mathbf A\mathbf B^{\mathrm T} &amp;= \mathbf U \mathbf D \mathbf V^{\mathrm T} 
\end{aligned}
$$<p>すると，</p>
$$
\begin{aligned}
\mathbf L'^{2} &amp;= \left(\mathbf U \mathbf D \mathbf V^{\mathrm T} \right)^{\mathrm T} \mathbf U \mathbf D \mathbf V^{\mathrm T} \\
&amp;= \mathbf V \mathbf D \mathbf U^{\mathrm T}\mathbf U \mathbf D \mathbf V^{\mathrm T} \\
&amp;= \mathbf V \mathbf D^{2} \mathbf V^{\mathrm T} \\
\end{aligned}
$$<p>であり，</p>
$$
\begin{aligned}
\mathbf L' &amp;= \mathbf V \sqrt{\mathbf D^{2}} \mathbf V^{\mathrm T} \\
&amp;=  \mathbf V  \begin{pmatrix}
\ddots &amp; &amp; \\
 &amp; \sqrt{d_{i}^{2}}&amp; \\
 &amp; &amp; \ddots\\
\end{pmatrix}
 \mathbf V^{\mathrm T} \\
 &amp;=  \mathbf V  \begin{pmatrix}
\ddots &amp; &amp; \\
 &amp; d_{i}s_{i}&amp; \\
 &amp; &amp; \ddots\\
\end{pmatrix}
 \mathbf V^{\mathrm T} \\
 &amp;=  \mathbf V \mathbf D \mathbf S \mathbf V^{\mathrm T}
\end{aligned}
$$<p>と表すことができます．なお，$\mathbf S = \mathop{\rm diag}s_{i}\ \left(s_{i} = \pm1\right)$となります．</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>次に，上式の両辺に対して行列式を考えます．すると，</p>
$$
\begin{aligned}
\left| \mathbf L' \right| &amp;= \left| \mathbf V \mathbf D \mathbf S \mathbf V^{\mathrm T} \right| \\
&amp;= \left| \mathbf V \right| \cdot \left| \mathbf D\right|  \cdot \left| \mathbf S\right|  \cdot \left| \mathbf V^{\mathrm T} \right| \\
\end{aligned}
$$<p>であり，$\left|\mathbf V\right| = \left|\mathbf V^{\mathrm T}\right| = 1$より，</p>
$$
\begin{aligned}
&amp;= \left| \mathbf D\right|  \cdot \left| \mathbf S\right| \\
\end{aligned}
$$<p>また，</p>
$$
\begin{aligned}
\mathbf R\mathbf L'  &amp;= \mathbf A \mathbf B^{\mathrm T} \\
\mathbf R^{\mathrm T}\mathbf R\mathbf L'  &amp;= \mathbf R^{\mathrm T}\mathbf A \mathbf B^{\mathrm T} \\
\mathbf L'  &amp;= \mathbf R^{\mathrm T}\mathbf A \mathbf B^{\mathrm T} \\
\end{aligned}
$$<p>であることから，</p>
$$
\begin{aligned}
\left| \mathbf L' \right|  &amp;= \left| \mathbf R^{\mathrm T} \right| \cdot \left| \mathbf A \mathbf B^{\mathrm T} \right| \\
&amp;= \left| \mathbf A \mathbf B^{\mathrm T} \right| \\
\end{aligned}
$$<p>となります．従って，
$$
\begin{aligned}
\left| \mathbf D\right|  \cdot \left| \mathbf S\right| &amp;=   \left| \mathbf A \mathbf B^{\mathrm T} \right| \\
\end{aligned}
$$</p>
<p>と表すことができます．また，特異値の性質より，$d_{i} \geq 0$であるため，</p>
$$
\begin{aligned}
\left| \mathbf D\right|  &amp;\geq 0 \\
\end{aligned}
$$<p>となります．従って，</p>
$$
\begin{aligned}
  \left| \mathbf S\right|&amp;= \begin{cases}
    1 &amp; \ \ \  \text{if}\ \ \left| \mathbf A \mathbf B^{\mathrm T} \right|  \geq 0 \\
    -1 &amp;\ \ \  \text{if}\ \ \left| \mathbf A \mathbf B^{\mathrm T} \right| \leq 0
  \end{cases}
\end{aligned}
$$<p>となります．ここで，$\left| \mathbf A - \mathbf R \mathbf B\right|^{2}$の最小化について考えます．以上の結果より$\left| \mathbf A - \mathbf R \mathbf B\right|^{2}$は，</p>
$$
\begin{aligned}
\left\| \mathbf A - \mathbf R \mathbf B\right\|^{2} &amp;= \mathrm{tr} \left(\left(\mathbf A - \mathbf R \mathbf B\right)^{\mathrm T} \left(\mathbf A - \mathbf R \mathbf B\right)  \right) \\
&amp;= \mathrm{tr}\left(\mathbf A^{\mathrm T}\mathbf A\right) - \mathrm{tr} \left(\mathbf A^{\mathrm T}\mathbf R \mathbf B\right)
 - \mathrm{tr} \left(\left(\mathbf R \mathbf B\right)^{\mathrm T}\mathbf A\right) + \mathrm{tr} \left(\left(\mathbf R \mathbf B\right)^{\mathrm T}\mathbf R \mathbf B\right)\\
&amp;= \left\|\mathbf A\right\|^{2} - \mathrm{tr} \left(\left(\left(\mathbf R \mathbf B\right)^{\mathrm T}\mathbf A\right)^{\mathrm T}\right) - \mathrm{tr} \left(\left(\mathbf R \mathbf B\right)^{\mathrm T}\mathbf A\right)  + \mathrm{tr} \left(\mathbf B^{\mathrm T} \mathbf R^{\mathrm T}\mathbf R \mathbf B\right)\\
&amp;=  \left\|\mathbf A\right\|^{2} - \mathrm{tr} \left(\left(\mathbf R \mathbf B\right)^{\mathrm T}\mathbf A\right) - \mathrm{tr} \left(\left(\mathbf R \mathbf B\right)^{\mathrm T}\mathbf A\right)  + \mathrm{tr} \left(\mathbf B^{\mathrm T} \mathbf B\right)\\
&amp;= \left\|\mathbf A\right\|^{2} + \left\|\mathbf B\right\|^{2} - 2 \mathrm{tr} \left(\left(\mathbf R \mathbf B\right)^{\mathrm T}\mathbf A\right)\\
&amp;= \left\|\mathbf A\right\|^{2} + \left\|\mathbf B\right\|^{2} - 2 \mathrm{tr} \left(\mathbf B^{\mathrm T}\mathbf R^{\mathrm T} \mathbf A\right)\\
&amp;= \left\|\mathbf A\right\|^{2} + \left\|\mathbf B\right\|^{2} - 2 \mathrm{tr} \left(\mathbf R^{\mathrm T} \mathbf A\mathbf B^{\mathrm T}\right)\\
&amp;= \left\|\mathbf A\right\|^{2} + \left\|\mathbf B\right\|^{2} - 2 \mathrm{tr} \left(\mathbf L'\right)\\
&amp;= \left\|\mathbf A\right\|^{2} + \left\|\mathbf B\right\|^{2} -2 \mathrm{tr} \left(\mathbf V\mathbf D\mathbf S\mathbf V^{\mathrm T}\right)\\
&amp;= \left\|\mathbf A\right\|^{2} + \left\|\mathbf B\right\|^{2} -2 \mathrm{tr} \left(\mathbf D\mathbf S\mathbf V^{\mathrm T}\mathbf V\right)\\
&amp;= \left\|\mathbf A\right\|^{2} + \left\|\mathbf B\right\|^{2} -2 \mathrm{tr} \left(\mathbf D\mathbf S\right)\\
&amp;= \left\|\mathbf A\right\|^{2} + \left\|\mathbf B\right\|^{2} -2 \left(d_{1}s_{1} + d_{2}s_{2} + \cdots + d_{m}s_{m} \right)\\
\end{aligned}
$$<p>と表すことができます．ここで，$\mathbf A$，$\mathbf B$，$d_{i}$が問題より与えられており，$\left\|\mathbf A\right\|^{2} \ge 0$，$\left\|\mathbf B\right\|^{2} \ge 0$となります．従って，$\text{minimize}\ \left\| \mathbf A - \mathbf R \mathbf B\right\|^{2}$は以下の様に書き換えることができます．</p>
$$
\begin{alignedat}{4}
 \text{maximize}  &amp; \ \ \ \ \  &amp;  d_{1}s_{1} + d_{2}s_{2} + \cdots + d_{m}s_{m}  &amp; \\
 \text{subject to} &amp;\ &amp; s_{1}s_{2} \cdots s_{m} &amp;=  \begin{cases}
    1 &amp; \ \ \  \text{if}\ \ \left| \mathbf A \mathbf B^{\mathrm T} \right|  \geq 0 \\
    -1 &amp; \ \ \  \text{if}\ \ \left| \mathbf A \mathbf B^{\mathrm T} \right| \leq 0
  \end{cases}&amp; \\
                   &amp;\ &amp; \left| s_{i} \right|  &amp;= 1
\end{alignedat}
$$<p>まず，$\left| \mathbf A \mathbf B^{\mathrm T} \right|  \geq 0$の場合について考えます．この時，$s_{i}=1$で目的関数が最大化することは明らかです．次に，$ \left| \mathbf A \mathbf B^{\mathrm T} \right| \leq 0$の場合について考えます．$d_{1} \geq d_{2} \geq \cdots \geq d_{m}$であるため，$s_{1} = s_{2} = \cdots = s_{m-1} = 1$，$s_{m} = -1$で目的関数が最大化します．</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>最後に，以上の結果を元に実際に$\mathbf R$を求めていきます．まず，$\mathrm{rank}\left(\mathbf A \mathbf B^{\mathrm T}\right) = m$である場合を考えます．この時，$\mathbf L'$は正則行列となります．よって，</p>
$$
\begin{aligned}
    \mathbf L'^{-1} &amp;= \left(\mathbf V \mathbf D \mathbf S \mathbf V^{\mathrm T}\right)^{-1} \\
    &amp;= \left( \mathbf V^{\mathrm T} \right)^{-1} \mathbf S^{-1} \mathbf D^{-1} \mathbf V^{-1} \\
    &amp;= \mathbf V \mathbf S \mathbf D^{-1} \mathbf V^{\mathrm T} \\
    &amp;= \mathbf V \mathbf D^{-1}\mathbf S \mathbf V^{\mathrm T}
\end{aligned}
$$<p>となります．従って，</p>
$$
\begin{aligned}
    \mathbf R &amp;= \mathbf A \mathbf B^{\mathrm T} \mathbf L'^{-1} \\
   &amp;= \mathbf U \mathbf D \mathbf V^{\mathrm T} \mathbf V \mathbf D^{-1} \mathbf S \mathbf V^{\mathrm T}\\
   &amp;= \mathbf U \mathbf S \mathbf V^{\mathrm T}
\end{aligned}
$$<p>となります．次に，$\mathrm{rank}\left(\mathbf A \mathbf B^{\mathrm T}\right) = m-1$である場合を考えます．</p>
$$
\begin{aligned}
 \mathbf A \mathbf B^{\mathrm T} &amp;=\mathbf U \mathbf D \mathbf V^{\mathrm T}\\
 \mathbf L' &amp;= \mathbf V \mathbf D \mathbf S \mathbf V^{\mathrm T} \\
  \mathbf R\mathbf L'  &amp;= \mathbf A \mathbf B^{\mathrm T} \\
\end{aligned}
$$<p>であるため，
$$
\begin{aligned}
  \mathbf R\mathbf L'  &amp;= \mathbf A \mathbf B^{\mathrm T}\\
  \mathbf R\left(\mathbf V \mathbf D \mathbf S \mathbf V^{\mathrm T} \right) &amp;= \mathbf U \mathbf D \mathbf V^{\mathrm T}\\
  \mathbf R\mathbf V \mathbf D \mathbf S \mathbf V^{\mathrm T} \mathbf V &amp;= \mathbf U \mathbf D \mathbf V^{\mathrm T}\mathbf V\\
  \mathbf R\mathbf V \mathbf D \mathbf S &amp;= \mathbf U \mathbf D \\
\end{aligned}
$$</p>
<p>ここで，$\mathrm{rank}\left(\mathbf A \mathbf B^{\mathrm T}\right) = m-1$であるため，$d_{m} = 0$となります．また，$s_{1} = s_{2} = \cdots = s_{m} = 1$であるため，</p>
$$
\begin{aligned}
  \mathbf D\mathbf S  &amp;= \mathbf D\\
\end{aligned}
$$<p>となります．よって，</p>
$$
\begin{aligned}
  \mathbf R\mathbf V \mathbf D &amp;= \mathbf U \mathbf D \\
\end{aligned}
$$<p>ここで，
$$
\begin{aligned}
\mathbf Q &amp;=  \mathbf U^{\mathrm T} \mathbf R\mathbf V \\
\left| \mathbf Q \right| &amp;= \left|  \mathbf U^{\mathrm T} \mathbf R\mathbf V \right|\\
&amp;= \left| \mathbf U^{\mathrm T}\right|\left| \mathbf R\right| \left|\mathbf V \right|\\
&amp;= \left| \mathbf U\right|\left|\mathbf V \right|
\end{aligned}
$$</p>
<p>と置くと，</p>
$$
\begin{aligned}
\mathbf U^{\mathrm T}   \mathbf R\mathbf V \mathbf D &amp;=\mathbf U^{\mathrm T}  \mathbf U \mathbf D \\
\mathbf Q\mathbf D &amp;= \mathbf D \\
\end{aligned}
$$<p>と表すことができます．さらに</p>
$$
\begin{aligned}
\mathbf Q &amp;= \left(\mathbf q_{1} \mathbf q_{2} \cdots \mathbf q_{m} \right)\\
\mathbf e_{i} &amp;= \left(e_{i,1}, e_{i,2}, \cdots, e_{i,m}\right)^{\mathrm T} \\
e_{i,j} &amp;= \begin{cases}
    0 &amp; \ \ \  \text{otherwise} \\
    1 &amp; \ \ \  \text{if}\ \ i=j
  \end{cases}
\end{aligned}
$$<p>と置くと，</p>
$$
\begin{aligned}
d_{i} \mathbf q_{i} &amp;= d_{i}\mathbf e_{i} \\
\mathbf q_{i} &amp;= \mathbf e_{i} \ \left( 1 \leq i \leq m - 1\right)
\end{aligned}
$$<p>となります．また，$\mathbf U$, $\mathbf R$, $\mathbf V$は全て直交行列です．従って$\mathbf Q$も同様に直交行列となります．そのため，$\mathbf q_{m}$は$\mathbf q_{1} \cdots \mathbf q_{m-1}$と直交します．従って，</p>
$$
\begin{aligned}
\mathbf q_{m} = \begin{cases}
    \mathbf e_{m}   &amp; \ \ \  \text{if}\ \ \left| \mathbf U\right|\left|\mathbf V \right| = 1\\
     -\mathbf e_{m} &amp; \ \ \  \text{if}\ \ \left| \mathbf U\right|\left|\mathbf V \right| = -1
  \end{cases}
\end{aligned}
$$<p>となります．以上の結果より，</p>
$$
\begin{aligned}
\mathrm{svd} \left(\mathbf A\mathbf B^{\mathrm T}\right) &amp;= \mathbf U \mathbf D \mathbf V^{\mathrm T}\\
\mathbf S &amp;= \begin{cases}
    \mathbf I   &amp; \ \ \  \text{if}\ \ \left| \mathbf U\right|\left|\mathbf V \right| = 1\\
    \mathrm{diag} \ \left(1, 1, \cdots, 1, -1\right) &amp; \ \ \  \text{if}\ \ \left| \mathbf U\right|\left|\mathbf V \right| = -1
  \end{cases}\\
\mathbf R &amp;= \mathbf U \mathbf Q \mathbf V^{\mathrm T}\\
&amp;=  \mathbf U \mathbf S \mathbf V^{\mathrm T}\\
\end{aligned}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="相似変換の推定">
<a class="anchor" href="#%E7%9B%B8%E4%BC%BC%E5%A4%89%E6%8F%9B%E3%81%AE%E6%8E%A8%E5%AE%9A" aria-hidden="true"><span class="octicon octicon-link"></span></a>相似変換の推定<a class="anchor-link" href="#%E7%9B%B8%E4%BC%BC%E5%A4%89%E6%8F%9B%E3%81%AE%E6%8E%A8%E5%AE%9A"> </a>
</h2>
<p>前述した通り，相似変換は以下の$e^{2}\left(c, \mathbf R, \mathbf t\right)$を最小化する$c, \mathbf R, \mathbf t$を求めることによって与えられます．</p>
$$
\begin{aligned}
e^{2}\left(c, \mathbf R, \mathbf t\right) &amp;= \frac{1}{n} \sum_{i=1}^{n} \left| \mathbf y_{i} - \left(c\mathbf R \mathbf x_{i} + \mathbf t\right)\right|^{2}
\end{aligned}
$$<p>ここで，$\mathbf X= \left(\mathbf x_{1}, \mathbf x_{2}, \cdots, \mathbf x_{n}\right)$，$\mathbf Y= \left(\mathbf y_{1}, \mathbf y_{2}, \cdots, \mathbf y_{n}\right)$，$\mathbf h = \left(1, 1, \cdots, 1\right)^{\mathrm T}$と置くと，</p>
$$
\begin{aligned}
e^{2}\left(c, \mathbf R, \mathbf t\right) &amp;= \frac{1}{n} \left\| \mathbf Y - c \mathbf R \mathbf X -\mathbf t \mathbf h^{\mathrm T}  \right\|^{\mathrm 2}
\end{aligned}
$$<p>と表現することができます．また，</p>
$$
\begin{aligned}
\mathbf K &amp;= \mathbf I - \frac{1}{n} \mathbf h \mathbf h^{\mathrm T} \\
\mathbf K &amp;= \mathbf K^{\mathrm T}\\
\mathbf K \mathbf K^{\mathrm T} &amp;= \mathbf K
\end{aligned}
$$<p>とすると，</p>
$$
\begin{aligned}
\mathbf X\mathbf K &amp;= \mathbf X\left(\mathbf I - \frac{1}{n} \mathbf h \mathbf h^{\mathrm T} \right)\\
&amp;= \mathbf X - \frac{1}{n}\mathbf X\mathbf h \mathbf h^{\mathrm T}\\
\mathbf X &amp;= \mathbf X\mathbf K + \frac{1}{n}\mathbf X \mathbf h \mathbf h^{\mathrm T}
\end{aligned}
$$<p>であり，同様に，</p>
$$
\begin{aligned}
\mathbf Y &amp;= \mathbf Y\mathbf K + \frac{1}{n}\mathbf Y \mathbf h \mathbf h^{\mathrm T}
\end{aligned}
$$<p>これらを用いて，$e^{2}\left(c, \mathbf R, \mathbf t\right)$を表すと，</p>
$$
\begin{aligned}
e^{2}\left(c, \mathbf R, \mathbf t\right) &amp;= \frac{1}{n} \left\|  \mathbf Y\mathbf K + \frac{1}{n}\mathbf Y \mathbf h \mathbf h^{\mathrm T} - c \mathbf R \left(\mathbf X\mathbf K + \frac{1}{n}\mathbf X \mathbf h \mathbf h^{\mathrm T}\right) -\mathbf t \mathbf h^{\mathrm T}  \right\|^{\mathrm 2}\\
&amp;= \frac{1}{n} \left\|  \mathbf Y\mathbf K + \frac{1}{n}\mathbf Y \mathbf h \mathbf h^{\mathrm T} - c \mathbf R \mathbf X\mathbf K -\frac{c}{n}\mathbf R\mathbf X \mathbf h \mathbf h^{\mathrm T} -\mathbf t \mathbf h^{\mathrm T}  \right\|^{\mathrm 2}\\
&amp;= \frac{1}{n} \left\|  \mathbf Y\mathbf K  - c \mathbf R \mathbf X\mathbf K + \left(\frac{1}{n}\mathbf Y \mathbf h -\frac{c}{n}\mathbf R\mathbf X \mathbf h  -\mathbf t\right) \mathbf h^{\mathrm T}  \right\|^{\mathrm 2}\\
&amp;= \frac{1}{n} \left\|  \mathbf Y\mathbf K  - c \mathbf R \mathbf X\mathbf K - \mathbf t' \mathbf h^{\mathrm T}  \right\|^{\mathrm 2}\\
&amp;=  \frac{1}{n} \mathrm{tr}\left(\left(\mathbf Y\mathbf K  - c \mathbf R \mathbf X\mathbf K - \mathbf t' \mathbf h^{\mathrm T} \right)^{\mathrm T}\left(\mathbf Y\mathbf K  - c \mathbf R \mathbf X\mathbf K - \mathbf t' \mathbf h^{\mathrm T} \right) \right)\\
&amp;= \frac{1}{n} \mathrm{tr}\left(\left(\mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right)^{\mathrm T}\left(\mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right) - \left(\mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right)^{\mathrm T}\left(\mathbf t' \mathbf h^{\mathrm T}  \right)
-\left(\mathbf t' \mathbf h^{\mathrm T}\right)^{\mathrm T}\left(\mathbf Y\mathbf K  - c \mathbf R \mathbf X\mathbf K\right)
+\left(\mathbf t' \mathbf h^{\mathrm T}\right)^{\mathrm T}\left(\mathbf t' \mathbf h^{\mathrm T} \right)
 \right)\\
 &amp;= \frac{1}{n}\left\{
 \mathrm{tr}\left(
     \left(\mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right)^{\mathrm T}\left(\mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right)
  \right)
     -\mathrm{tr}\left(
         \left(\mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right)^{\mathrm T}\left(\mathbf t' \mathbf h^{\mathrm T}  \right)
         \right)
         -\mathrm{tr}\left(
\left(\mathbf t' \mathbf h^{\mathrm T}\right)^{\mathrm T}\left(\mathbf Y\mathbf K  - c \mathbf R \mathbf X\mathbf K\right)\right)+\mathrm{tr}\left(
\left(\mathbf t' \mathbf h^{\mathrm T}\right)^{\mathrm T}\left(\mathbf t' \mathbf h^{\mathrm T} \right)
  \right)
 \right\}\\
 &amp;= \frac{1}{n}\left\{
 \left\| \mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right\|^{2} + \left\|\mathbf t' \mathbf h^{\mathrm T}  \right\|^{2}
      -\mathrm{tr}\left(
         \left(\mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right)^{\mathrm T}\left(\mathbf t' \mathbf h^{\mathrm T}  \right)
         \right)
         -\mathrm{tr}\left(\left(
\left(\mathbf t' \mathbf h^{\mathrm T}\right)^{\mathrm T}\left(\mathbf Y\mathbf K  - c \mathbf R \mathbf X\mathbf K\right)
  \right)^{\mathrm T}\right)
  \right\}\\
 &amp;= \frac{1}{n}\left\{
 \left\| \mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right\|^{2} + \left\|\mathbf t' \mathbf h^{\mathrm T}  \right\|^{2}
      -\mathrm{tr}\left(
         \left(\mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right)^{\mathrm T}\left(\mathbf t' \mathbf h^{\mathrm T}  \right)
         \right)
         -\mathrm{tr}\left(
         \left(\mathbf Y\mathbf K  - c \mathbf R \mathbf X\mathbf K\right)^{\mathrm T}
\left(\mathbf t' \mathbf h^{\mathrm T}\right)
\right)
  \right\}\\
   &amp;= \frac{1}{n}\left\{
 \left\| \mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right\|^{2} + \left\|\mathbf t' \mathbf h^{\mathrm T}  \right\|^{2}
      -2\mathrm{tr}\left(
         \left(\mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right)^{\mathrm T}\left(\mathbf t' \mathbf h^{\mathrm T}  \right)
         \right)
  \right\}\\
     &amp;= \frac{1}{n}\left\{
 \left\| \mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right\|^{2} + \left\|\mathbf t' \mathbf h^{\mathrm T}  \right\|^{2}
      -2\mathrm{tr}\left(
         \left(\mathbf K^{\mathrm T}\mathbf Y^{\mathrm T} - c \mathbf K^{\mathrm T} \mathbf X^{\mathrm T}\mathbf R^{\mathrm T}\right)\left(\mathbf t' \mathbf h^{\mathrm T}  \right)
         \right)
  \right\}\\
      &amp;= \frac{1}{n}\left\{
 \left\| \mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right\|^{2} + \left\|\mathbf t' \mathbf h^{\mathrm T}  \right\|^{2}
      -2\mathrm{tr}\left(\mathbf K^{\mathrm T}
         \left(\mathbf Y^{\mathrm T} - c \mathbf X^{\mathrm T}\mathbf R^{\mathrm T}\right)\left(\mathbf t' \mathbf h^{\mathrm T}  \right)
         \right)
  \right\}\\
        &amp;= \frac{1}{n}\left\{
 \left\| \mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right\|^{2} + \left\|\mathbf t' \mathbf h^{\mathrm T}  \right\|^{2}
      -2\mathrm{tr}\left(\mathbf K
         \left(\mathbf Y^{\mathrm T} - c \mathbf X^{\mathrm T}\mathbf R^{\mathrm T}\right)\left(\mathbf t' \mathbf h^{\mathrm T}  \right)
         \right)
  \right\}\\
\end{aligned}
$$<p>なお，</p>
$$
\begin{aligned}
\mathbf t' &amp;= -\frac{1}{n}\mathbf Y \mathbf h +\frac{c}{n}\mathbf R\mathbf X \mathbf h  +\mathbf t
\end{aligned}
$$<p>と置いています．ここで，右辺第３項について考えます．
$$
\begin{aligned}
\mathrm{tr}\left(\mathbf K
         \left(\mathbf Y^{\mathrm T} - c \mathbf X^{\mathrm T}\mathbf R^{\mathrm T}\right)\mathbf t' \mathbf h^{\mathrm T} 
         \right) &amp;=\mathrm{tr}\left(\mathbf h^{\mathrm T}  \mathbf K
         \left(\mathbf Y^{\mathrm T} - c \mathbf X^{\mathrm T}\mathbf R^{\mathrm T}\right)\mathbf t' 
         \right) \\
         &amp;= \mathrm{tr}\left(\mathbf h^{\mathrm T}  \left( \mathbf I - \frac{1}{n} \mathbf h \mathbf h^{\mathrm T} \right)
         \left(\mathbf Y^{\mathrm T} - c \mathbf X^{\mathrm T}\mathbf R^{\mathrm T}\right)\mathbf t' 
         \right) \\
         &amp;= \mathrm{tr}\left( \left( \mathbf h^{\mathrm T} - \frac{1}{n} \mathbf h^{\mathrm T}\mathbf h \mathbf h^{\mathrm T} \right)
         \left(\mathbf Y^{\mathrm T} - c \mathbf X^{\mathrm T}\mathbf R^{\mathrm T}\right)\mathbf t' 
         \right) \\
                  &amp;= \mathrm{tr}\left( \left( \mathbf h^{\mathrm T} - \mathbf h^{\mathrm T} \right)
         \left(\mathbf Y^{\mathrm T} - c \mathbf X^{\mathrm T}\mathbf R^{\mathrm T}\right)\mathbf t' 
         \right) \\
         &amp;= 0
\end{aligned}
$$</p>
<p>次に右辺第２項について考えます．
$$
\begin{aligned}
\left\|\mathbf t'\mathbf h^{\mathrm T} \right\|^{2}&amp;= n\left\| \mathbf t'\right\|^{2}
\end{aligned}
$$</p>
<p>以上の結果より，</p>
$$
\begin{aligned}
e^{2}\left(c, \mathbf R, \mathbf t\right) &amp;= \frac{1}{n}
 \left\| \mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right\|^{2} 
+ \left\| \mathbf t'\right\|^{2}
\end{aligned}
$$<p>と表されます．$e^{2}\left(c, \mathbf R, \mathbf t\right)$を最小化するために，$\mathbf t'=0$と置くと，</p>
$$
\begin{aligned}
\mathbf t' &amp;= -\frac{1}{n}\mathbf Y \mathbf h +\frac{c}{n}\mathbf R\mathbf X \mathbf h  +\mathbf t\\
&amp;= 0\\
\end{aligned}
$$<p>従って，</p>
$$ 
\begin{aligned}
\mathbf t &amp;= \frac{1}{n}\mathbf Y \mathbf h - \frac{c}{n}\mathbf R\mathbf X \mathbf h
\end{aligned}
$$<p>ここで，
$$   
\begin{aligned}
\mathbf{\mu_{y}} &amp;= \frac{1}{n}\mathbf Y \mathbf h\\
\mathbf{\mu_{x}} &amp;= \frac{1}{n}\mathbf X \mathbf h
\end{aligned}
$$</p>
<p>と置くと，
$$   
\begin{aligned}
\mathbf t &amp;=  \mathbf{\mu_{y}} - c\mathbf R\mathbf{\mu_{x}}
\end{aligned}
$$</p>
<p>並進成分が求まったので，再度評価関数$e^{2}$を書き下すと，</p>
$$
\begin{aligned}
e^{2}\left(c, \mathbf R, \mathbf t = \mathbf{\mu_{y}} - c\mathbf R\mathbf{\mu_{x}}\right) &amp;= \frac{1}{n}
 \left\| \mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right\|^{2} 
\end{aligned}
$$<p>ここで，$\frac{1}{n}\mathbf Y \mathbf K \mathbf X^{\mathrm T}$の特異値分解を以下の様に置きます．
$$
\begin{aligned}
\frac{1}{n}\mathbf Y \mathbf K \mathbf X^{\mathrm T} &amp;= \mathbf U \mathbf D \mathbf V^{\mathrm T}
\end{aligned}
$$</p>
<p>すると，</p>
$$
\begin{aligned}
\left(\mathbf Y \mathbf K\right)\left(c\mathbf X \mathbf K\right)^{\mathrm T} &amp;= c\mathbf Y \mathbf K \mathbf K^{\mathrm T}\mathbf X^{\mathrm T}\\
&amp;= c \mathbf Y \mathbf K\mathbf X^{\mathrm T}\\
&amp;= cn\mathbf U \mathbf D\mathbf V^{\mathrm T}\\
\end{aligned}
$$<p>また，回転行列の推定の結果より，
$$
\begin{aligned}
\frac{1}{n}\left\| \mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right\|^{2} &amp;= \frac{1}{n} \left\{
\left\|\mathbf Y \mathbf K\right\|^{2} + c^{2}\left\|\mathbf X \mathbf K\right\|^{2} - 2\mathrm{tr} \left(cn\mathbf U \mathbf D\mathbf V^{\mathrm T}\right)
\right\}
\end{aligned}
$$</p>
<p>上式を$c$について最小化すると，</p>
$$
\begin{aligned}
\frac{\partial}{\partial c} \frac{1}{n}\left\| \mathbf Y\mathbf K - c \mathbf R \mathbf X\mathbf K\right\|^{2}&amp;= \frac{1}{n} \left\{2 c\left\|\mathbf X \mathbf K\right\|^{2} - 2n\mathrm{tr} \left(\mathbf U \mathbf D\mathbf V^{\mathrm T}\right)
\right\}\\
&amp;= 0\\
c &amp;= \frac{\mathrm{tr} \left(\mathbf D\mathbf S\right)}{\frac{1}{n}\left\|\mathbf X\mathbf K\right\|^{2}}
\end{aligned}
$$<p>ここで，</p>
$$
\begin{aligned}
\sigma_{x}^{2}&amp;= \frac{1}{n}\left\|\mathbf X\mathbf K\right\|^{2}
\end{aligned}
$$<p>とおくと，</p>
$$
\begin{aligned}
c &amp;= \frac{\mathrm{tr} \left(\mathbf D\mathbf S\right)}{\sigma_{x}^{2}}
\end{aligned}
$$<p>また，回転行列$\mathbf R$についても同様に</p>
$$
\begin{aligned}
\mathbf R &amp;=  \mathbf U \mathbf S \mathbf V^{\mathrm T}\\
\mathbf S &amp;= \begin{cases}
    \mathbf I   &amp; \ \ \  \text{if}\ \ \left| \mathbf U\right|\left|\mathbf V \right| = 1\\
    \mathrm{diag} \ \left(1, 1, \cdots, 1, -1\right) &amp; \ \ \  \text{if}\ \ \left| \mathbf U\right|\left|\mathbf V \right| = -1
  \end{cases}\\
\end{aligned}
$$<p>以上の結果をまとめると，
$$
\begin{aligned}
c &amp;= \frac{\mathrm{tr} \left(\mathbf D\mathbf S\right)}{\sigma_{x}^{2}}\\
\mathbf R &amp;=  \mathbf U \mathbf S \mathbf V^{\mathrm T}\\
\mathbf S &amp;= \begin{cases}
    \mathbf I   &amp; \ \ \  \text{if}\ \ \left| \mathbf U\right|\left|\mathbf V \right| = 1\\
    \mathrm{diag} \ \left(1, 1, \cdots, 1, -1\right) &amp; \ \ \  \text{if}\ \ \left| \mathbf U\right|\left|\mathbf V \right| = -1
  \end{cases}\\
  \mathbf t &amp;=  \mathbf{\mu_{y}} - c\mathbf R\mathbf{\mu_{x}}\\
\end{aligned}
$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pythonによる実装">
<a class="anchor" href="#Python%E3%81%AB%E3%82%88%E3%82%8B%E5%AE%9F%E8%A3%85" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pythonによる実装<a class="anchor-link" href="#Python%E3%81%AB%E3%82%88%E3%82%8B%E5%AE%9F%E8%A3%85"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>上述の方法をPythonで実装しました．青色の点が$\mathbf X$を，橙色の点が$\mathbf Y$を，緑色の点が$c\mathbf R\mathbf X$をそれぞれ表しています．橙色の点ど緑色の点が重なっていることから，パラメータの推定が適切に行われていることを確認できます．</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">random</span><span class="p">()</span>
<span class="n">cs</span><span class="p">,</span> <span class="n">ss</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">cs</span><span class="p">,</span> <span class="o">-</span><span class="n">ss</span><span class="p">],</span> <span class="p">[</span><span class="n">ss</span><span class="p">,</span> <span class="n">cs</span><span class="p">]])</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">noise</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">R</span> <span class="o">@</span> <span class="n">X</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="n">noise</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="n">h</span> <span class="o">@</span> <span class="n">h</span><span class="o">.</span><span class="n">T</span>

<span class="n">U</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">Y</span> <span class="o">@</span> <span class="n">K</span> <span class="o">@</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> 
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">U</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="p">])</span>
<span class="n">R_pred</span> <span class="o">=</span> <span class="n">U</span> <span class="o">@</span> <span class="n">S</span> <span class="o">@</span> <span class="n">V</span><span class="o">.</span><span class="n">T</span>
<span class="n">c_pred</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">D</span><span class="p">)</span> <span class="o">@</span> <span class="n">S</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">X</span> <span class="o">@</span> <span class="n">K</span> <span class="o">@</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">t_pred</span> <span class="o">=</span> <span class="p">((</span><span class="n">Y</span> <span class="o">@</span> <span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">c_pred</span> <span class="o">*</span> <span class="n">R_pred</span> <span class="o">@</span> <span class="n">X</span> <span class="o">@</span> <span class="n">h</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">Y_pred</span> <span class="o">=</span> <span class="n">c_pred</span> <span class="o">*</span> <span class="n">R_pred</span> <span class="o">@</span> <span class="n">X</span> <span class="o">+</span> <span class="n">t_pred</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"x"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"y"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">y</span> <span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">"X"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"tab:blue"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">y</span> <span class="o">=</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Y"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"tab:orange"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Y_pred</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">y</span> <span class="o">=</span><span class="n">Y_pred</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Y_pred"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"tab:green"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="参考">
<a class="anchor" href="#%E5%8F%82%E8%80%83" aria-hidden="true"><span class="octicon octicon-link"></span></a>参考<a class="anchor-link" href="#%E5%8F%82%E8%80%83"> </a>
</h2>
<ol>
<li>Least-Squares Estimation of Transformation Parameters Between Two Point Patterns, S. Umeyama, 1991</li>
<li>Matrix Cookbook, Kaare Brandt Petersen, Michael Syskind Pedersen, 2005</li>
</ol>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/imageprocessing/geometry/2020/11/08/read-umeyama-1991-paper.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>My lab notebook</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/ar90n" title="ar90n"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/ar90n" title="ar90n"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
