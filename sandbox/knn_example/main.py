# %%
import numpy as np
from pynndescent import NNDescent
# %%
x = np.array([
    [0.9382979, 0.02068228],
	[0.73769548, 0.27789461],
	[0.52404968, 0.66918405],
	[0.71130657, 0.04397154],
	[0.30150448, 0.99551993],
	[0.71053094, 0.80725171],
	[0.83579555, 0.27047663],
	[0.92257152, 0.35443522],
	[0.75475991, 0.03915375],
	[0.47519988, 0.79546934],
	[0.41285849, 0.91768804],
	[0.95689047, 0.53087249],
	[0.54369358, 0.72449079],
	[0.21832251, 0.95516216],
	[0.93584569, 0.75276496],
	[0.55507164, 0.35825514],
	[0.53575104, 0.31743178],
	[0.86958985, 0.79659692],
	[0.71037628, 0.12494913],
	[0.47549219, 0.91082355],
	[0.76717885, 0.70570274],
	[0.25268384, 0.49687757],
	[0.36881297, 0.00942773],
	[0.07258602, 0.26554888],
	[0.29408366, 0.89540884],
	[0.24222268, 0.3205058],
	[0.47095961, 0.57133958],
	[0.79535941, 0.37627325],
	[0.16554462, 0.10079731],
	[0.704429, 0.05787501],
	[0.80916261, 0.22355085],
	[0.6309418, 0.51406197]
])

# %%
k = 6
diversify_prob=1.0,
index = NNDescent(x, n_neighbors=k, diversify_prob=diversify_prob)
# %%
np.sum(index.neighbor_graph[1])
